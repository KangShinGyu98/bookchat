<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>BookChat</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="./assets/css/style.css" />
    <!-- bootstrap icon -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" />
  </head>
  <body class="bg-primary">
    <nav class="border-bottom d-flex justify-content-between align-items-center">
      <a class="p-2" href="index.html">목록</a>
      <div class="d-flex gap-1 m-2">
        <div class="d-flex justify-content-center align-items-center">
          <span class="nickname-badge small text-muted" id="nickname-badge"></span>
        </div>
        <div class="dropdown me-2">
          <button class="btn btn-sm position-relative" id="notificationBell" data-bs-toggle="dropdown" aria-expanded="false" type="button">
            <i class="bi bi-bell"></i>
            <span id="notificationBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-notification d-none"> </span>
          </button>
          <div class="dropdown-menu notification-menu p-0 shadow" aria-labelledby="notificationBell" id="notification-menu">
            <div class="d-flex justify-content-between align-items-center">
              <span class="text-muted small p-2">알림</span>

              <!-- Bootstrap Switch 대신 form-check form-switch -->
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="notificationToggle" checked />
              </div>
            </div>
            <div class="dropdown-divider m-0"></div>
            <div class="spinner-container" id="notification-container">
              <div class="spinner-border text-secondary" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
            </div>
          </div>
        </div>
        <button class="btn btn-sm btn-outline-secondary" id="loginOpenBtn" type="button"><i class="bi bi-box-arrow-in-right m-1"></i> 로그인</button>
      </div>
    </nav>
    <main class="main-container my-5">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
          <h5 id="bookTitle" class="mb-1 bookTitle">로딩중...</h5>
          <div class="text-muted small">
            <span id="bookMeta"></span>
            <span id="membersCount"> </span>
          </div>
        </div>

        <div class="d-flex align-self-stretch align-items-end">
          <div class="d-flex justify-content-center align-items-center gap-1" id="btn-container">
            <div class="form-check form-switch">
              <label class="form-check-label text-muted text-sm" for="autoSubscribeChecked">자동 구독</label>
              <input class="form-check-input" type="checkbox" role="switch" id="autoSubscribeChecked" checked />
            </div>
            <button class="btn btn-sm btn-outline-secondary" id="subscribeBtn" type="button"><i class="bi bi-bookmark-plus m-1"></i>구독</button>
            <button class="btn btn-sm btn-outline-secondary" id="newQuestionOpenBtn" type="button"><i class="bi bi-plus-lg m-1"></i>질문</button>
            <div class="dropdown me-2">
              <button class="btn btn-sm btn-outline-secondary" id="newRatingOpenBtn" data-bs-toggle="dropdown" aria-expanded="false" type="button">
                <i class="bi bi-heart m-1"></i>추천
              </button>
              <div class="dropdown-menu pt-2 px-2 shadow rating-menu" aria-labelledby="newRatingOpenBtn" id="rating-menu">
                <div class="d-flex justify-content-between align-items-center pb-1">
                  <span class="text-muted small">추천하시겠습니까?</span>

                  <!-- Bootstrap Switch 대신 form-check form-switch -->
                  <span id="ratingValueDisplay" class="text-muted small">0</span>
                </div>
                <div class="dropdown-divider pb-2 m-0"></div>
                <input
                  type="range"
                  class="form-range"
                  id="newRating"
                  name="rating"
                  min="0"
                  max="5"
                  step="1"
                  value="0"
                  title="0~5 사이에서 선택하세요"
                />
                <div class="d-flex justify-content-between">
                  <span class="text-muted small">추천하지 않는다.</span><span class="text-muted small">매우 추천한다.</span>
                </div>
              </div>
            </div>
            <!-- <button class="btn btn-sm btn-outline-secondary" id="subscribeBtn" type="button"><i class="bi bi-bookmark-plus m-1"></i>구독</button>
            <button class="btn btn-sm btn-outline-secondary d-none" id="unSubscribeBtn" type="button">
              <i class="bi bi-bookmark-check m-1"></i>구독 중
            </button> -->
          </div>
        </div>
      </div>
      <div class="border bg-white chat-card rounded">
        <div id="carouselControls" class="carousel slide" data-bs-ride="carousel" data-bs-interval="50000">
          <div class="carousel-inner text-muted text-sm" id="carouselInner">
            <!-- <div class="carousel-item active">
              <div class="question-item">
                <div class="question-text">
                  "테스트용 질문입니다. 1번 데미안은 과연 테스트용 질문입니다. 1번 데미안은 과연 테스트용 질문입니다. 1번 데미안은 과연 "
                </div>
              </div>
            </div>
            <div class="carousel-item">
              <div class="question-item">
                <div class="question-text">"테스트용 질문 두번째입니다. 2번 좁은문에서 좁은 문은"</div>
              </div>
            </div>
            <div class="carousel-item">
              <div class="question-item">
                <div class="question-text">"테스트용 질문 세번째입니다. 3번 질문 내용은 무엇일까요?"</div>
              </div>
            </div> -->
          </div>
          <a class="carousel-control-prev" href="#carouselControls" role="button" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#carouselControls" role="button" data-bs-slide="next">
            <span class="sr-only">Next</span>
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
          </a>
        </div>
        <div id="messages" class="messages p-3"></div>
        <form id="msgForm" class="input-group input-group-sm w-100">
          <textarea
            class="form-control form-control-sm rounded-end-0 rounded-top-0 border-bottom-0 border-start-0 border-end-0 p-2"
            name="msgInput"
            id="msgInput"
            placeholder="메시지 입력..."
            rows="1"
            autocomplete="off"
          ></textarea>
          <button class="btn btn-sm btn-outline-secondary bg-success rounded-start-0 rounded-top-0 border-top-0 px-3" type="submit" id="chatInputBtn">
            입력
          </button>
        </form>
      </div>
    </main>
    <!-- 질문등록 모달 -->
    <div class="modal fade" id="newQuestionModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content position-relative" id="newQuestionModalContent">
          <div id="modalLoadingOverlay" class="modal-loading-overlay d-none">
            <div class="spinner-border" role="status" aria-label="loading"></div>
          </div>
          <div class="modal-header">
            <h5 class="modal-title">새 질문 작성</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="newQuestionForm" class="d-flex flex-column gap-3">
              <!-- <div class="bg-primary rounded d-flex justify-content-between align-items-center p-2">
                <p class="p-0 m-0">기존에 작성한 질문입니다.</p>
                <button type="button" class="btn-close text-sm"></button>
              </div>
              <div class="bg-primary rounded d-flex justify-content-between align-items-center p-2">
                <p class="p-0 m-0">기존에 작성한 질문입니다.</p>
                <button type="button" class="btn-close text-sm"></button>
              </div>
              <div class="bg-primary rounded d-flex justify-content-between align-items-center p-2">
                <p class="p-0 m-0">기존에 작성한 질문입니다.</p>
                <button type="button" class="btn-close text-sm"></button>
              </div> -->
              <div id="questions-container"></div>
              <div class="spinner-container" id="question-spinner-container">
                <div class="spinner-border text-secondary" role="status">
                  <span class="visually-hidden">Loading...</span>
                </div>
              </div>
              <div>
                <input type="text" class="form-control" id="newQuestion" placeholder="ex) 데미안은 실존 인물일까요?" autocomplete="off" />
              </div>

              <div class="d-flex gap-2">
                <button id="enrollQuestionBtn" type="submit" class="btn btn-dark w-100">등록</button>
                <button id="cancelQuestionBtn" type="button" class="btn btn-outline-secondary w-100">취소</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- js파일 -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
      crossorigin="anonymous"
    ></script>
    <script type="module" src="./js/app.js"></script>
    <script type="module" src="./js/data.js"></script>
    <script type="module" src="./js/chat.js"></script>
    <script type="module" src="./js/login.js"></script>
    <script type="module" src="./js/bookMemberRender.js"></script>
  </body>
</html>
